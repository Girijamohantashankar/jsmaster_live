"use strict";(()=>{var e={};e.id=870,e.ids=[870],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5184:e=>{e.exports=require("nodemailer")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},8626:(e,t,r)=>{r.r(t),r.d(t,{config:()=>g,default:()=>m,routeModule:()=>h});var o={};r.r(o),r.d(o,{default:()=>f});var n=r(1802),s=r(7153),a=r(6249),i=r(1163),l=r(3248);r(9344);var p=r(5184),d=r.n(p);process.env.JWT_SECRET;let u=()=>Math.floor(1e5+9e5*Math.random()).toString(),c=async(e,t)=>{let r=d().createTransport({service:"Gmail",auth:{user:process.env.EMAIL_USER,pass:process.env.EMAIL_PASS}}),o={from:process.env.EMAIL_USER,to:e,subject:"JSMaster - Your OTP Verification Code",html:`
        <div style="font-family: Arial, sans-serif; color: #333;">
            <div style="text-align: center;">
                <img src="YOUR_LOGO_URL" alt="JSMaster Logo" style="width: 150px; margin-bottom: 10px;" />
                <h1 style="color: #4CAF50; font-size: 28px; margin: 0;">JSMaster</h1>
            </div>
            <h2 style="color: #4CAF50;">Welcome to JSMaster!</h2>
            <p>Dear ${username},</p>
            <p>Thank you for choosing JSMaster. To complete your login or registration process, please use the OTP code provided below:</p>
            <p style="font-size: 20px; font-weight: bold; color: #000;">${t}</p>
            <p>This code is valid for the next 2 minutes. Please do not share this code with anyone.</p>
            <p>If you did not request this code, please ignore this email.</p>
            <br />
            <p>Best regards,</p>
            <p>The JSMaster Team</p>
        </div>
    `};await r.sendMail(o)};async function f(e,t){if(await (0,i.Z)(),"POST"===e.method){let{email:r}=e.body;try{let e=await l.Z.findOne({email:r});if(!e)return console.error("User not found"),t.status(400).json({message:"User not found"});let o=u(),n=Date.now()+12e4;e.otp=o,e.otpExpiry=n,await e.save(),await c(r,o),t.status(200).json({message:"OTP has been resent to your email."})}catch(e){console.error("Server error:",e),t.status(500).json({message:"Server error"})}}else t.status(405).json({message:"Method not allowed"})}let m=(0,a.l)(o,"default"),g=(0,a.l)(o,"config"),h=new n.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/resend-otp",pathname:"/api/resend-otp",bundlePath:"",filename:""},userland:o})},1163:(e,t,r)=>{r.d(t,{Z:()=>i});var o=r(1185),n=r.n(o);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let a=global.mongoose;a||(a=global.mongoose={conn:null,promise:null});let i=async function(){return a.conn||(a.promise||(a.promise=n().connect(s,{bufferCommands:!1}).then(e=>e)),a.conn=await a.promise),a.conn}},3248:(e,t,r)=>{r.d(t,{Z:()=>a});var o=r(1185),n=r.n(o);let s=new(n()).Schema({username:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String,required:!0},phone:{type:String,required:!0},gender:{type:String,required:!0},otp:{type:String,default:null},otpExpiry:{type:Date,default:null},isVerified:{type:Boolean,default:!1},resetPasswordToken:{type:String,default:null},resetPasswordExpires:{type:Date,default:null}}),a=n().models.User||n().model("User",s)},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=8626);module.exports=r})();